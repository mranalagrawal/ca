query getCustomerOrders(
  $customerAccessToken: String!,
  $lang: LanguageCode!,
  $query: String = "processed_at:>2020-01-01"
) @inContext(language: $lang) {
  customer(customerAccessToken: $customerAccessToken) {
    id
    firstName
    orders(first: 10, reverse: true, query: $query) {
      nodes {
        billingAddress {
          city
          country
          address1
          address2
          zip
          name
          phone
          formattedArea
        }
        id
        name
        currencyCode
        currentSubtotalPrice { amount, currencyCode }
        currentTotalDuties { amount, currencyCode }
        currentTotalPrice { amount, currencyCode }
        currentTotalTax { amount, currencyCode }
        subtotalPrice { amount, currencyCode }
        totalShippingPrice { amount, currencyCode }
        totalPrice { amount, currencyCode }
        fulfillmentStatus
        orderNumber
        processedAt
        statusUrl
        financialStatus
        shippingAddress {
          city
          country
          address1
          address2
          zip
          name
          phone
          formattedArea
        }
        successfulFulfillments(first: 1) {
          trackingCompany
          trackingInfo {
            number,
            url
          }
        }
        lineItems(first: 10) {
          nodes {
            quantity
            title
            originalTotalPrice {
              amount
              currencyCode
            }
            discountedTotalPrice {
              amount
              currencyCode
            }
            variant {
              availableForSale
              compareAtPrice { amount, currencyCode }
              id
              price { amount, currencyCode }
              compareAtPrice { amount, currencyCode }
              image { altText, height, url, width }
              sku
              quantityAvailable
              metafield: metafield(namespace: "custom", key: "details") {
                value
              }
              product {
                availableForSale
                descriptionHtml
                handle
                id
                isGiftCard
                featuredImage { altText, height, url, width }
                seo { description, title }
                tags
                title
                vendor
                totalInventory
                details: metafield(namespace: "custom", key: "details") {
                  value
                }
                breadcrumbs: metafield(namespace: "custom", key: "breadcrumbs") {
                  value
                }
                variants(first: 1) {
                  nodes {
                    id
                    compareAtPrice { amount, currencyCode }
                    price { amount, currencyCode }
                    quantityAvailable
                    sku
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
